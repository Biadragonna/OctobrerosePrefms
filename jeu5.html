<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Octobre Rose ‚Äî Mots m√™l√©s Interactif</title>
  <style>
    :root{
      --bg:#fde9ef; --accent:#d95386; --accent-dark:#b83a60; --box:#ffdff0; --text:#7a2942; --muted:#b86a86; --cell:#8f3b55;
    }
    body{margin:0;font-family:system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial; background:var(--bg); color:var(--text); -webkit-font-smoothing:antialiased;}
    .page{max-width:960px;margin:14px auto;padding:16px;background:linear-gradient(180deg,var(--bg),#ffeef6 60%);border-radius:10px;box-shadow:0 8px 30px rgba(150,0,60,0.06);} 
    header{text-align:center;margin-bottom:12px}
    h1{margin:0;font-size:30px;color:var(--accent-dark)}
    .subtitle{color:var(--muted);margin-top:6px}
    .menu{display:flex;gap:8px;justify-content:center;margin:12px 0;flex-wrap:wrap}
    .btn{background:var(--accent);color:white;border:0;padding:10px 14px;border-radius:8px;cursor:pointer;font-weight:700;box-shadow:0 3px 0 rgba(0,0,0,0.08)}
    .btn.secondary{background:transparent;color:var(--accent-dark);border:2px solid rgba(184,58,96,0.14)}
    .controls{display:flex;gap:8px;justify-content:center;flex-wrap:wrap;margin-bottom:10px}
    .panel{background:var(--box);border-radius:10px;border:3px solid rgba(184,58,96,0.2);padding:12px}
    .grid-title{font-weight:800;color:var(--accent-dark);margin-bottom:8px;text-align:center}
    .grid-wrap{display:flex;justify-content:center;padding:8px}
    .grid{display:grid;gap:4px;touch-action:none}
    .cell{width:32px;height:32px;display:flex;align-items:center;justify-content:center;font-weight:800;color:var(--cell);background:transparent;border-radius:6px;user-select:none;transition:transform .12s, box-shadow .12s}
    .cell.found{box-shadow:0 6px 14px rgba(0,0,0,0.08);transform:scale(1.06);}
    .cell.active{outline:2px solid rgba(217,83,134,0.28);transform:scale(1.04)}
    .word-controls{display:flex;gap:8px;align-items:center;justify-content:center;margin-top:8px;flex-wrap:wrap}
    .hidden-words{background:#fff0f6;border-radius:8px;padding:10px;margin-top:8px}
    .footer{text-align:center;margin-top:14px;font-weight:700;color:var(--accent-dark)}

    /* timer & scoreboard */
    .timer{font-weight:900;font-size:18px;color:var(--accent-dark);display:flex;gap:8px;align-items:center}
    .timer .time{min-width:72px;text-align:center;background:#fff;border-radius:8px;padding:6px 10px;border:2px solid rgba(184,58,96,0.12)}
    .controls-right{display:flex;gap:8px;align-items:center}

    /* modal */
    .modal-back{position:fixed;inset:0;background:rgba(0,0,0,0.35);display:none;align-items:center;justify-content:center;padding:20px}
    .modal{background:white;padding:18px;border-radius:12px;max-width:720px;width:100%;box-shadow:0 20px 60px rgba(0,0,0,0.2)}
    table{width:100%;border-collapse:collapse;margin-top:10px}
    th,td{padding:8px;border-bottom:1px solid #eee;text-align:left}
    .ribbon{display:inline-flex;gap:8px;align-items:center;font-weight:800;padding:6px 8px;border-radius:20px;color:white}
    .ribbon.gold{background:linear-gradient(90deg,#ffd54a,#e6b800);color:#4a2b00}
    .ribbon.silver{background:linear-gradient(90deg,#cfcfcf,#9fa0a2);color:#222}
    .ribbon.bronze{background:linear-gradient(90deg,#d7a07a,#b56b3a);color:#311a08}
    .ribbon.pink{background:linear-gradient(90deg,#ff9fc1,#ff6fa0)}

    /* small confetti animation (for wins) */
    .confetti-piece{position:fixed;width:10px;height:14px;opacity:0;pointer-events:none;z-index:9999}

    @keyframes dropConf{0%{transform:translateY(-20vh) rotate(0) scale(0.9);opacity:1}100%{transform:translateY(120vh) rotate(540deg) scale(1);opacity:1}}

    @media (max-width:700px){ .cell{width:28px;height:28px;font-size:14px} .btn{padding:8px 10px} h1{font-size:24px} }
    @media print{ .menu,.controls,.word-controls,label{display:none} .page{box-shadow:none;border-radius:0} }
  </style>
</head>
<body>
  <div class="page">
    <header>
      <h1>Octobre Rose</h1>
      <div class="subtitle">Le ruban qui nous unit ‚Äî mot m√™l√© interactif</div>
    </header>

    <div class="menu">
      <button class="btn" id="mode-medium">üå∏ Niveau Moyen</button>
      <button class="btn" id="mode-hard">üå∫ Niveau Difficile</button>
    </div>

    <div class="controls">
      <div style="display:flex;gap:8px;align-items:center">
        <button class="btn secondary" id="regenerate">üîÑ G√©n√©rer √† nouveau</button>
        <button class="btn secondary" id="toggle-solution">üëÄ Montrer la solution</button>
        <button class="btn secondary" id="export-pdf">üìÑ Exporter en PDF</button>
      </div>
      <div style="flex:1"></div>
      <div class="controls-right">
        <div class="timer">‚è±Ô∏è <div class="time" id="timeDisplay">05:00</div></div>
        <button class="btn" id="startTimer">‚ñ∂Ô∏è D√©marrer</button>
        <button class="btn secondary" id="pauseTimer">‚è∏Ô∏è Pause</button>
        <button class="btn secondary" id="resetTimer">üîÅ R√©initialiser</button>
      </div>
    </div>

    <div class="panel">
      <div class="grid-title" id="gridTitle">Niveau Moyen ‚Äî 15 mots</div>
      <div class="grid-wrap">
        <div id="gridContainer" aria-label="Grille de mots m√™l√©s"></div>
      </div>

      <div class="word-controls">
        <label><input type="checkbox" id="showWordsChk"> Afficher la liste des mots</label>
        <div style="min-width:12px"></div>
        <div id="foundCounter" style="font-weight:700;color:var(--muted)"></div>
      </div>

      <div class="hidden-words" id="wordList"> <!-- hidden by default --> </div>
    </div>

    <div class="footer">Ensemble pour la pr√©vention et le d√©pistage üíó</div>
  </div>

  <!-- modal scoreboard -->
  <div class="modal-back" id="modalBack">
    <div class="modal" role="dialog" aria-modal="true">
      <h2>Tableau des scores</h2>
      <div id="finalSummary"></div>

      <form id="scoreForm" style="display:flex;gap:8px;flex-wrap:wrap;align-items:center;margin-top:8px">
        <input required id="playerName" placeholder="Nom" style="padding:8px;border-radius:8px;border:1px solid #eee;flex:1">
        <input required id="playerFiliere" placeholder="Fili√®re" style="padding:8px;border-radius:8px;border:1px solid #eee;flex:1">
        <button class="btn" type="submit">Enregistrer</button>
        <button class="btn secondary" id="closeModal" type="button">Fermer</button>
      </form>

      <div id="scoreboardList"></div>
    </div>
  </div>

  <!-- confetti container -->
  <div id="confettiRoot"></div>

  <script>
  /* === Configuration mots === */
  const MEDIUM_WORDS = ["RUBAN","PREVENTION","DEPISTAGE","SOLIDARITE","SOUTIEN","COURAGE","ESPOIR","VIE","ROSE","MAMMOGRAPHIE","RADIOLOGIE","MANIP","IMAGERIE","PATIENTE","SANTE"]; 
  const HARD_WORDS = ["EQUIPE","DETERMINATION","ESPERANCE","BIOPSIE","SUIVI","DIAGNOSTIC","ONCOLOGIE","RADIO","ULTRASONS","BILATERALITE","PREVENTIF","CONSULTATION","RADIOTHERAPIE","MALADIE","SENSIBILISER","ADHERENCE","THERAPIE","EXAMEN","RECHERCHE","PROTOCOLE"];

  /* palette pour couleurs distinctes par mot */
  const WORD_COLORS = ["#ff6fa0","#ff9fc1","#e6739c","#d95386","#b83a60","#ffb3d6","#ff80bf","#e667a2","#f2a6c9","#d98fb3","#c76090","#a84c78","#ff66a3","#ff4d94","#ffa3c9","#ff8fb8","#f07aa3","#d95b8c","#c74779","#b03062"];

  /* === √âtat global === */
  let mode = 'medium'; // 'medium' or 'hard'
  let grid = []; // 2D array of letters
  let placements = []; // placed words with coords: {word,start:[r,c],dir:[dr,dc],len,color}
  let foundWords = new Set();

  /* timer state */
  let timerSeconds = 300; // default 5 minutes
  let timerInterval = null;
  let timerRunning = false;

  /* scoreboard storage key */
  const STORAGE_KEY = 'octobre_scoreboard_v1';

  /* === Utilitaires === */
  const rand = (a,b) => Math.floor(Math.random()*(b-a+1))+a;
  const shuffle = (arr) => arr.slice().sort(()=>Math.random()-0.5);
  const dirs = (all)=> all ? [[0,1],[0,-1],[1,0],[-1,0],[1,1],[1,-1],[-1,1],[-1,-1]] : [[0,1],[1,0],[1,1],[-1,1]];

  /* === Construction / placement === */
  function createEmpty(n){ return Array.from({length:n},()=>Array(n).fill('')); }
  function fillRandom(g){ const letters="ABCDEFGHIJKLMNOPQRSTUVWXYZ"; for(let i=0;i<g.length;i++) for(let j=0;j<g.length;j++) if(!g[i][j]) g[i][j] = letters[rand(0,letters.length-1)]; }

  function placeWords(g,words,allowReverse){
    const n=g.length; const D=dirs(allowReverse); const p=[]; const palette = WORD_COLORS.slice();
    for(const W of shuffle(words)){
      const word=W.toUpperCase(); let placed=false, tries=0;
      while(!placed && tries<5000){ tries++; const [dr,dc] = D[rand(0,D.length-1)]; const useRev = allowReverse && Math.random()<0.5; const w = useRev ? word.split('').reverse().join('') : word; const L = w.length; const r0 = rand(0,n-1), c0 = rand(0,n-1);
        if(r0+dr*(L-1)<0||r0+dr*(L-1)>=n||c0+dc*(L-1)<0||c0+dc*(L-1)>=n) continue;
        let ok=true, r=r0, c=c0;
        for(let k=0;k<L;k++){ if(g[r][c] && g[r][c] !== w[k]){ ok=false; break; } r+=dr; c+=dc; }
        if(!ok) continue;
        r=r0; c=c0; for(let k=0;k<L;k++){ g[r][c] = w[k]; r+=dr; c+=dc; }
        const color = palette.length ? palette.shift() : ('#'+Math.floor(Math.random()*16777215).toString(16));
        p.push({word:word, start:[r0,c0], dir:[dr,dc], len:L, color}); placed=true;
      }
      if(!placed) console.warn("Impossible de placer:",W);
    }
    return p;
  }

  /* === G√©n√©ration complete d'une grille === */
  function generateGrid(){ foundWords.clear(); placements = []; const words = mode==='medium' ? MEDIUM_WORDS : HARD_WORDS; const size = mode==='medium' ? 15 : 17; const allowRev = mode==='hard'; grid = createEmpty(size); placements = placeWords(grid, words, allowRev); fillRandom(grid); render(); updateWordList(); updateFoundCounter(); }

  /* === Rendu DOM === */
  function render(){ const container = document.getElementById('gridContainer'); container.innerHTML = ''; const n = grid.length; const gridEl = document.createElement('div'); gridEl.className = 'grid'; const cellSize = Math.max(24, Math.floor(Math.min(32, 520/n)));
    gridEl.style.gridTemplateColumns = `repeat(${n}, ${cellSize}px)`;
    for(let r=0;r<n;r++){
      for(let c=0;c<n;c++){
        const cell = document.createElement('div');
        cell.className = 'cell';
        cell.dataset.r = r; cell.dataset.c = c; cell.dataset.pos = `${r}-${c}`;
        cell.textContent = grid[r][c];
        gridEl.appendChild(cell);
      }
    }
    container.appendChild(gridEl);
    attachSelectionHandlers(gridEl);
    renderWordListColors();
  }

  function renderWordListColors(){ const listEl = document.getElementById('wordList'); const words = mode==='medium' ? MEDIUM_WORDS : HARD_WORDS; // map to placements to fetch colors (if not placed yet, fallback)
    const mapping = {};
    for(const p of placements) mapping[p.word] = p.color;
    const html = ['<strong>Mots √† trouver :</strong><br><ul style="padding-left:18px;margin:8px 0">'];
    for(const w of words){ const col = mapping[w.toUpperCase()] || '#b83a60'; const cls = foundWords.has(w) ? 'style="text-decoration:line-through;opacity:0.7"' : ''; html.push(`<li ${cls}><span style="display:inline-block;width:12px;height:12px;background:${col};border-radius:4px;margin-right:8px;vertical-align:middle"></span><span style="vertical-align:middle;color:${col};font-weight:700">${w}</span></li>`); }
    html.push('</ul>'); listEl.innerHTML = html.join(''); if(!document.getElementById('showWordsChk').checked) listEl.style.display='none'; else listEl.style.display='block';
  }

  function updateWordList(){ renderWordListColors(); }
  function updateFoundCounter(){ const total = mode==='medium' ? MEDIUM_WORDS.length : HARD_WORDS.length; document.getElementById('foundCounter').textContent = `${foundWords.size} / ${total} trouv√©s`; }

  /* === Solution toggler === */
  let solutionShown=false;
  function toggleSolution(){ const allCells = document.querySelectorAll('.cell'); if(!solutionShown){ for(const p of placements){ let [r,c] = p.start; for(let k=0;k<p.len;k++){ const el = document.querySelector(`.cell[data-pos="${r}-${c}"]`); if(el){ el.classList.add('found'); el.style.background = `linear-gradient(180deg, ${p.color}33, ${p.color}22)`; el.style.color = '#4a1b36'; } r += p.dir[0]; c += p.dir[1]; } } solutionShown=true; document.getElementById('toggle-solution').textContent = "üîí Masquer la solution"; } else { document.querySelectorAll('.cell').forEach(el=>{ const pos = el.dataset.pos; // if this cell is part of any actually found word, keep it; else remove
        let keep=false; for(const fw of foundWords){ for(const p of placements.filter(pp => pp.word === fw)){ let [r,c] = p.start; for(let k=0;k<p.len;k++){ if(`${r}-${c}` === pos) keep=true; r+=p.dir[0]; c+=p.dir[1]; } } }
        if(!keep){ el.classList.remove('found'); el.style.background=''; el.style.color=''; }
      }); solutionShown=false; document.getElementById('toggle-solution').textContent = "üëÄ Montrer la solution"; } }

  /* === Sound utilities (WebAudio simple tones) === */
  const audioCtx = (window.AudioContext || window.webkitAudioContext) ? new (window.AudioContext || window.webkitAudioContext)() : null;
  function playTone(freq=440, duration=0.12, type='sine'){ if(!audioCtx) return; const o = audioCtx.createOscillator(); const g = audioCtx.createGain(); o.type = type; o.frequency.value = freq; g.gain.value = 0.08; o.connect(g); g.connect(audioCtx.destination); o.start(); o.stop(audioCtx.currentTime + duration); }

  /* confetti generator */
  function spawnConfetti(count=30){ const root = document.getElementById('confettiRoot'); for(let i=0;i<count;i++){ const el = document.createElement('div'); el.className='confetti-piece'; el.style.left = (Math.random()*100)+'%'; el.style.top = (-Math.random()*20-10)+'vh'; el.style.background = WORD_COLORS[Math.floor(Math.random()*WORD_COLORS.length)]; el.style.width = (6+Math.random()*10)+'px'; el.style.height = (8+Math.random()*14)+'px'; el.style.borderRadius = '2px'; el.style.transform = `rotate(${Math.random()*360}deg)`; el.style.animation = `dropConf ${2.4+Math.random()*1.6}s linear forwards`; root.appendChild(el); setTimeout(()=>{ el.remove(); }, 4200); }
  }

  /* === Interaction de s√©lection === */
  let selecting=false; let selCells=[]; let pointerId=null;
  function attachSelectionHandlers(gridEl){ gridEl.onpointerdown = null; gridEl.onpointermove = null; gridEl.onpointerup = null; gridEl.onpointercancel = null; gridEl.addEventListener('pointerdown', onPointerDown); gridEl.addEventListener('pointermove', onPointerMove); window.addEventListener('pointerup', onPointerUp); window.addEventListener('pointercancel', onPointerUp);

    function cellFromPoint(x,y){ const el = document.elementFromPoint(x,y); if(!el) return null; return el.closest('.cell'); }
    function onPointerDown(e){ if(e.button && e.button !== 0) return; selecting = true; pointerId = e.pointerId; gridEl.setPointerCapture(pointerId); selCells = []; clearActive(); const cell = e.target.closest('.cell'); if(cell){ const r = +cell.dataset.r, c = +cell.dataset.c; selCells.push([r,c]); markActive(); } e.preventDefault(); }
    function onPointerMove(e){ if(!selecting || e.pointerId !== pointerId) return; const cell = cellFromPoint(e.clientX,e.clientY); if(!cell) return; const r = +cell.dataset.r, c = +cell.dataset.c; const last = selCells[selCells.length-1]; if(selCells.some(([rr,cc]) => rr===r && cc===c)) return; if(selCells.length===1){ const dr = r - last[0], dc = c - last[1]; if(Math.abs(dr) <=1 && Math.abs(dc) <=1){ selCells.push([r,c]); markActive(); } return; } const first = selCells[0], second = selCells[1]; const dirR = second[0]-first[0], dirC = second[1]-first[1]; const expectedR = last[0] + dirR, expectedC = last[1] + dirC; if(r === expectedR && c === expectedC){ selCells.push([r,c]); markActive(); } else { const penultimate = selCells[selCells.length-2]; if(penultimate && penultimate[0]===r && penultimate[1]===c){ selCells.pop(); markActive(); } } }
    function onPointerUp(e){ if(!selecting) return; selecting=false; try{ gridEl.releasePointerCapture(pointerId); }catch(err){} evaluateSelection(); selCells=[]; clearActive(); pointerId=null; }

    function clearActive(){ gridEl.querySelectorAll('.cell.active').forEach(el=>el.classList.remove('active')); }
    function markActive(){ clearActive(); for(const [r,c] of selCells){ const el = gridEl.querySelector(`.cell[data-pos="${r}-${c}"]`); if(el) el.classList.add('active'); } }

    function evaluateSelection(){ if(selCells.length < 2) return; const chars = selCells.map(([r,c])=>grid[r][c]).join(''); const charsRev = chars.split('').reverse().join(''); const words = mode==='medium' ? MEDIUM_WORDS : HARD_WORDS; const found = words.find(w => w === chars || w === charsRev);
      if(found){ if(foundWords.has(found)) { playTone(240,0.07,'square'); return; } foundWords.add(found); // determine placement color
        const placement = placements.find(p=>p.word===found || (p.word.split('').reverse().join('')===found)); const col = placement ? placement.color : '#d95386'; // mark selected cells
        const gridElRoot = document.getElementById('gridContainer'); for(const [r,c] of selCells){ const el = gridElRoot.querySelector(`.cell[data-pos="${r}-${c}"]`); if(el){ el.classList.add('found'); el.style.background = `linear-gradient(180deg, ${col}33, ${col}22)`; el.style.color = '#4a1b36'; } }
        updateFoundCounter(); renderWordListColors(); playTone(880,0.12,'sine'); spawnConfetti(10);
        const total = mode==='medium' ? MEDIUM_WORDS.length : HARD_WORDS.length; if(foundWords.size === total) setTimeout(()=>showEndModal(true), 300); } else { // not found feedback
        const gridElRoot = document.getElementById('gridContainer'); for(const [r,c] of selCells){ const el = gridElRoot.querySelector(`.cell[data-pos="${r}-${c}"]`); if(el) el.classList.add('active'); }
        playTone(200,0.08,'sine'); setTimeout(()=>{ clearActive(); }, 220);
      }
    }
  }

  /* === UI wiring === */
  document.getElementById('mode-medium').addEventListener('click', ()=>{ mode='medium'; document.getElementById('gridTitle').textContent='Niveau Moyen ‚Äî 15 mots'; generateGrid();});
  document.getElementById('mode-hard').addEventListener('click', ()=>{ mode='hard'; document.getElementById('gridTitle').textContent='Niveau Difficile ‚Äî 20 mots'; generateGrid();});
  document.getElementById('regenerate').addEventListener('click', ()=>{ generateGrid(); });
  document.getElementById('toggle-solution').addEventListener('click', ()=>{ toggleSolution(); });
  document.getElementById('export-pdf').addEventListener('click', ()=>{ window.print(); });
  document.getElementById('showWordsChk').addEventListener('change', (e)=>{ document.getElementById('wordList').style.display = e.target.checked ? 'block' : 'none'; });

  /* === Timer controls === */
  const timeDisplay = document.getElementById('timeDisplay'); function formatTime(s){ const mm = String(Math.floor(s/60)).padStart(2,'0'); const ss = String(s%60).padStart(2,'0'); return `${mm}:${ss}`; }
  function updateDisplay(){ timeDisplay.textContent = formatTime(timerSeconds); }
  function startTimer(){ if(timerRunning) return; timerRunning = true; timerInterval = setInterval(()=>{ if(timerSeconds<=0){ stopTimer(); showEndModal(false); return; } timerSeconds--; updateDisplay(); }, 1000); }
  function stopTimer(){ timerRunning=false; if(timerInterval){ clearInterval(timerInterval); timerInterval=null; } }
  document.getElementById('startTimer').addEventListener('click', ()=>{ // unlock audio on first user gesture
    try{ if(audioCtx && audioCtx.state === 'suspended') audioCtx.resume(); }catch(e){}
    startTimer(); });
  document.getElementById('pauseTimer').addEventListener('click', ()=>{ stopTimer(); });
  document.getElementById('resetTimer').addEventListener('click', ()=>{ stopTimer(); timerSeconds = mode==='medium' ? 300 : 420; updateDisplay(); });

  // initialize timer based on mode
  function initTimerByMode(){ timerSeconds = mode==='medium' ? 300 : 420; updateDisplay(); }

  /* === End modal & scoreboard === */
  const modalBack = document.getElementById('modalBack');
  function showEndModal(allFound){ // prepare summary
    stopTimer(); const score = foundWords.size; const total = mode==='medium' ? MEDIUM_WORDS.length : HARD_WORDS.length; document.getElementById('finalSummary').innerHTML = `Score : <strong>${score}</strong> / ${total} mots trouv√©s<br>` + (allFound ? '<em>Bravo ‚Äî tous les mots ont √©t√© trouv√©s !</em>' : '<em>Temps √©coul√© ou fin de partie</em>'); modalBack.style.display='flex'; }
  document.getElementById('closeModal').addEventListener('click', ()=>{ modalBack.style.display='none'; });

  document.getElementById('scoreForm').addEventListener('submit',(e)=>{ e.preventDefault(); const name = document.getElementById('playerName').value.trim(); const filiere = document.getElementById('playerFiliere').value.trim(); const score = foundWords.size; const when = new Date().toISOString(); if(!name || !filiere) return; const board = JSON.parse(localStorage.getItem(STORAGE_KEY) || '[]'); board.push({name,filiere,score,mode,when}); // keep only last 200
    localStorage.setItem(STORAGE_KEY, JSON.stringify(board.slice(-200))); renderScoreboard(); modalBack.style.display='none'; });

  function renderScoreboard(){ const board = JSON.parse(localStorage.getItem(STORAGE_KEY) || '[]'); // keep only same mode for ranking
    const boardMode = board.filter(b=>b.mode===mode).sort((a,b)=>b.score-a.score || new Date(b.when)-new Date(a.when));
    const container = document.getElementById('scoreboardList'); if(boardMode.length===0){ container.innerHTML = '<p>Aucun score enregistr√© pour ce mode.</p>'; return; }
    let html = `<table><thead><tr><th>Rang</th><th>Nom</th><th>Fili√®re</th><th>Score</th><th>Date</th></tr></thead><tbody>`;
    boardMode.forEach((row,i)=>{ let ribbonClass='pink'; if(i===0) ribbonClass='gold'; else if(i===1) ribbonClass='silver'; else if(i===2) ribbonClass='bronze'; const date = new Date(row.when).toLocaleString(); html += `<tr><td><span class="ribbon ${ribbonClass}">${i+1}</span></td><td>${row.name}</td><td>${row.filiere}</td><td>${row.score}</td><td>${date}</td></tr>`; });
    html += '</tbody></table>'; container.innerHTML = html; }

  // show scoreboard before starting if user wants
  function loadAndShowScores(){ renderScoreboard(); }

  /* === Initial generate === */
  generateGrid(); initTimerByMode(); loadAndShowScores();

  // ensure reset timer when switching modes
  document.getElementById('mode-medium').addEventListener('click', ()=>{ timerSeconds = 300; updateDisplay(); renderScoreboard(); });
  document.getElementById('mode-hard').addEventListener('click', ()=>{ timerSeconds = 420; updateDisplay(); renderScoreboard(); });

  </script>
</body>
</html>

